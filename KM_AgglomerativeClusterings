import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.datasets import make_blobs
from sklearn.cluster import KMeans, AgglomerativeClustering
from scipy.cluster.hierarchy import dendrogram, linkage

X, y_true = make_blobs(n_samples=200, centers=4, cluster_std=0.7, random_state=42)
kmeans = KMeans(n_clusters=4, random_state=42, n_init=10)
y_kmeans = kmeans.fit_predict(X)
plt.figure(figsize=(6,5))
sns.scatterplot(x=X[:,0], y=X[:,1], hue=y_kmeans, palette="tab10", s=40)
plt.scatter(kmeans.cluster_centers_[:,0], kmeans.cluster_centers_[:,1],
            c="red", marker="X", s=200, label="Centroids")
plt.title("KMeans Clustering")
plt.legend()
plt.show()
agg = AgglomerativeClustering(n_clusters=4, linkage="ward")
y_agg = agg.fit_predict(X)
plt.figure(figsize=(6,5))
sns.scatterplot(x=X[:,0], y=X[:,1], hue=y_agg, palette="tab10", s=40)
plt.title("Agglomerative Clustering (Ward)")
plt.show()
Z = linkage(X, method="ward")
plt.figure(figsize=(10,4))
dendrogram(Z, truncate_mode="lastp", p=20, leaf_rotation=45., leaf_font_size=10., show_contracted=True)
plt.title("Hierarchical Clustering Dendrogram (truncated)")
plt.xlabel("Cluster size")
plt.ylabel("Distance")
plt.show()
